provider "malwaredomains"
name "domain_reputation"
fetch_http('http://mirror1.malwaredomains.com/files/domains.txt')

filter_whitespace
filter_comments

parse_eachline(:separator => "\n") do |event_generator, record|
  fields = record.data.split(/\t/)
  next if record.nil?
  
  # null_string  = fields[0]
  # expires = fields[1]
  remote_domain = fields[2]
  # description = fields[3]
  # source = fields[4]
  # detecttime1 = fields[5]
  # detecttime2 = fields[6]
  # detecttime3 = fields[7]
  # detecttime4 = fields[8]
  # relisted = fields[9]
  
  event_generator.call() do |event|
    event.type = :malware_host
    event.add_fqdn(remote_domain)
    end
end
